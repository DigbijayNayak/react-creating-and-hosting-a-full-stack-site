# Creating a Node.js Back End

## 1. Why Node.js?

- All right, so now that we've got our client side working nicely, it's time to start building the backend of our blog. And to do this, we're going to be using Node.js. Now, you've probably already heard about Node.js by now and you should have it installed locally on your computer.
- If you don't, you're going to want to head to nodejs.org and download the Long Term Support or current version of Node.js. And Node.js is really important for us because it allows us to write our backend in JavaScript instead of in PHP or Python or Java.
- Right, as I said in the introduction, it used to be that in order to be a full stack developer you had to be fairly fluent in more than one programming language, but with Node.js, which has become an incredibly popular framework since it was released, our entire web application can now be written in JavaScript, which is great news for JavaScript developers like us.
- Now, there are many different npm packages that can be used to create Node.js servers. And the one we're going to be using in these videos is called Express. Now, Express is a great choice for us because it's unopinionated, it's very easy to get started with, and it's also very well documented and you can feel free to take a look at the documentation for Express just by going to expressjs.com and looking at the API reference.
- And in addition to this, there are a ton of third-party add-ons that can be used to extend Express's functionality, which, as we'll see later on, can really come in handy. So without further ado, let's get started creating our backend with Node.js in Express.
- https://nodejs.org/en/docs
- https://expressjs.com/en/4x/api.html

## 2. Setting up an Express server

- All right. To get started creating a backend for our app with NodeJS and Express, what we're going to do is create a directory outside of this front end directory that we've been working with so far, right? That we called my blog. So what you're going to want to do is open up a terminal and type CD and then dot. And that will send you back out into the parent folder.
- And then what we're going to do is just create a new folder inside of here alongside our my blog directory. And we'll call that something like my blog backend. So what you're going to do for that, assuming of course that you're on Mac this may well be different if you're on Windows. So just look up how to create a new directory in Windows or whatever operating system you're on.
- And then you're going to say my blog backend, right? So this is the name that you want for the directory. Okay, so once we've created that, we're just going to open that up in visual studio code and you can either do that just by going to file open in visual studio code.
- Or if you have your terminal setup to do this, you can just say code and then my blog backend, and that should open it for you in a new window. Okay, so we now have this nice empty directory. And what we're going to do here is initialize this as a new NPM package. And the way that we can do that is again by opening a terminal here and running the command `npm init -y` which will do things like create a new package.json file inside our folder and help us keep track of different things about our backend project. All right.
- So once we've done that, the next thing that we're going to do is install the express package which we're going to be using to build our server. And the way we're going to do that is by running the command `npm install express`, and hitting enter, and that should install express for us. And the next thing that we're going to do now is create a source folder where we'll be storing all of our source codes. So what we're going to do is just right click inside of here and do new folder.
- And we'll just call this folder source. And this will contain all of our server side code. And the last file that we're going to need to create here is a file called server.js. And this is where we're going to be writing all of our server code, but before we write our server code, what we're going to want to do is set up this project so that we can use modern JavaScript, syntax such as the import and export syntax. And in order to do that, this used to actually be a lot more complicated.
- You used to have to install Babel and set up a Babel RC but now all you have to do in order to make that syntax work, is go into your package.json file and add a single property to that called type. And the value for that is going to be module and make sure that you add a comma on the end of that line, because if not, it will cause an error. Like this `"type": "module",`. Cool, so now that we've added that we can start creating our new express server inside this server.js file. So this is a pretty straightforward thing to do.
- And what we're going to do as an example, is we're just going to create a very simple express server that sends us a message when we send a request to it. So the first thing that we need to do here is import the express package that we just installed. And we can do that by saying `import express from 'express'`. And after we've done that, we're going to create a new express app by saying const app equals.
- And then we're going to say express and call that as a function like this `const app = express();`, which will create a new express app for us. Okay, so now that we have this app object, we can define different end points and what we want our server to do when one of those endpoints receives a request. So let's start off very simply, let's make it so that when our app receives a get request on an endpoint slash hello, it will simply respond with a message saying, hello. Like this

  ```js
  app.get("/hello", (req, res) => {
    res.send("Hello!");
  });
  ```

- All right, pretty simple, straightforward. It's a good hello world program to do. Okay, so in order to make our express app do that, all we have to do is say app.get, this is the type of the request here. And then app.get takes two arguments. The first one is going to be the route, right? The specific path that we want to listen for. And the second argument here is a callback that gets called whenever this endpoint receives a request. So this callback has two main arguments. The first one is a request object which contains details about the request that we received.
- And the second one is a response object which we can use to send a response back to whoever sent the request. Okay, so for our purposes, what we're going to do is just say request a response. And the body of this callback function is just going to say response.send and we'll send back the message, hello, okay? And response.send here is one of several functions that we can use to send back a response in this case, a response as you can see is just the string hello. Okay, so we've defined the endpoint behavior.
- So the last thing that we have to do is tell our server to listen, and this is going to be done by saying app.listen. And this function takes an argument to specify which port we should listen on. So we'll just do 8,000 here. And it's also going to take a callback that will get called once the server is actually listening. And we usually just use this to log out a message to the console saying that the server is listening. So inside here, we can just say console.log. And we'll say, server is listening on port 8,000. (keyboard clicks) Okay, and that's all there is to it. All we have to do now is use NodeJS to run our express server. And the command that we have to use for that, is `node src/server.js`.
- And if we hit enter now, we'll see that it says server is listening on port 8,000. And what we should be able to do now is go over to a browser and enter in local host 8,000 slash hello and hit enter. And what we'll see sure enough is the response that we got from the server saying hello. So everything's working great so far. Next, we're going to see how we can actually make our app do some useful things. And we're also going to take a look at a better tool for testing our server.

## 3. Testing an Express server with Postman

- All right. So we've created a very simple express server, and as we move forward with our server development, it's going to be very important for us to have an easy and reliable way to test it. So far, what we've done is we've just typed the URL into our browser and this has worked but for some of the more complicated operations we're going to want to implement, this isn't going to be quite good enough.
- So what I'm going to recommend you do is head over to postman.com/downloads and download a piece of software called Postman, which is a very, very helpful program for testing servers as you're building them. And this is what it looks like when you open it up.
- So once you've downloaded and installed Postman, let's use it to actually query our backend. So what we're going to do is run our server. If you have your server running, that's great. If you don't have it running you're going to want to run it again with node source/server.JS, and make sure that it logs out server is listening on port 8000.
- And then what you're going to do is open up Postman and we'll use it to send a get request to the Hello endpoint. And the way that you do this is by clicking on the little plus button up here. And that might be in a different place depending on if Postman is updated. But anyway, just find a way to get this window up. And what you're going to do in here is type in HTTP, colon slash slash local host 8000/hello and notice over here that we have get selected.
- There's all different types of requests that you can select from this, and we'll get to that shortly. But for now, let's just send a get request to that endpoint that we created on our server and what we should see if we click the send button, is sure enough we get back this response Hello. All right. So that's the basics of using the Postman tool.
- There are obviously a lot more things that you can change about the request that you're sending and we'll get to those shortly. But first let's talk a little bit about making different types of requests in Postman. Now, for those of you who aren't familiar with different types of requests, such as get and post and all of the other ones that are in here, all you need to know for this course is that get requests are used to load information, usually from the server, such as an article content or a user's information and post requests, if you select that from the dropdown here, post requests are usually used to create some sort of new resource on the server.
- And there is one last type of request that we're going to be using and that is a put request. Put requests are usually used to update data on the server. Okay, so we're going to be using all of these as we develop our backend and bring it together with our front end. But before we can effectively use post requests and put requests, what we're going to want to do first is actually get a little bit of experience with these requests because they're a little bit different from just sending a basic get request.
- A get request, as we saw, basically just sends a simple request to a specific path, as we saw and usually it will get back some sort of response. However, post requests and put requests have the ability to carry extra information in something called a request body or request payload.
- So let's take a quick look at an example of making a post request to our server and actually including a payload. So what we're going to do is just select post from the dropdown. And before we add any extra body to this request, let's just try sending a post request to our server and see what happens if we send it to the same path that we defined our route handler for earlier. Okay. If we click send, what you're going to see is that we get back this HTML basically telling us that there was some kind of error on the server and specifically it says, cannot post Hello.
- So when we create the different endpoints on our server, like this one here, where we said app.get, these endpoints are only going to respond to the specific type of request that we selected. So in other words, if we want this to respond to a post request, we need to change it to app.post. And this is just something that express does for us. It's a really nice API to work with just because it makes it so simple to tell whether an endpoint is a post endpoint or a get endpoint or a put endpoint.
- So if we restart our server, and you do have to manually restart your server here in order for these changes to take effect, we'll take a look at how to add the ability to automatically restart your server very shortly. But now if we go back over to Postman and click send and send a post request to that endpoint we'll see that we get back that same request. And likewise, if we try and send a get request to that endpoint now we'll see that we get the error saying cannot get Hello.
- So anyway, the point of all of this is that when you define your different endpoints you need to be aware of what method get post put or any of these other ones you're using when you define them so that you can know what type of request to send to that endpoint. So now that we've seen how to send post requests and define post request handlers on the server, let's actually try sending some extra information in the form of a request body. And the way that you do this in Postman is by selecting this body tab here and then you're going to select raw. And from the dropdown here, you're going to select JSON.
- So we're going to be sending a request that contains JSON data to our server. And what we're going to do in here is just provide some very simple data. We're going to say name, and I'm just going to use my name here. Although you should definitely feel free to use your own name. And let's click send now. And what we should see is that we just get back the regular response.
- So our server isn't doing anything with this request body yet. So let's head back over to our server. And when you define a post endpoint like this one here, usually what you'll want to do is get access to that information in the request body. So the way that you do that is by saying request.body, we're using this request argument here and we're just taking a look at its body property. And if we log this out right now what you're going to see, if we restart our server here and we'll go back to Postman and click send. If we go back now to our terminal what we're going to see is something kind of strange. It says undefined. Now this is something that really tends to confuse people who are new to know JS.
- In order for the body property to work correctly in an express application, we have to add a little piece of what's called middleware to our app. Basically middleware is just extra functionality that our server will automatically execute. And what it's going to look like is this. We're going to say app.use... And this does have to be above where we define our endpoints.
- We're going to say app.use and then express.JSON. So basically what this line is telling express to do is when it receives a request that has a JSON body, a JSON payload, it's going to parse that and automatically make that available to us on request.body. So now if we restart our server again and go back to Postman, click send and then go back and take a look at our terminal here, we should see that now we have that object that we included in Postman. Okay.
- So one last thing. Let's just make this Hello endpoint say Hello to the person, to the name that is specified in the request body. For that all we need to do is say hello and then we'll change these to back ticks here so that we can insert the value of that variable. So we'll say request.body.name. And if we restart our server once more here, we should be able to go back to Postman and click send and see that it says, hello and well, mine says Sean, but yours should hopefully say your name. Alright. So that's how to handle post requests and take a look at the body. Obviously, this is a very simple example, but as we move on we're going to see some very useful situations where things like post requests and request bodies will come in handy.

## 4. URL parameters in Express

## 5. Upvoting articles

## 6. Automatically updating with nodemon

## 7. Adding comments
