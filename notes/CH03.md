# Adding MongoDB to Node.js

## 1. Why MongoDB?

- All right, so now that we've built out a very basic server using node JS and Express for our full stack application, the next thing that we're going to do is see how to persist our data in a database. Now, since both our client and server side are written in JavaScript, it makes sense to persist our data in a database that plays very nicely with JavaScript and has a similar format to the kind of data that we want to store.
- And for that, we don't need to look any further than MongoDB. Now, MongoDB is what's called a non-relational database, and basically what this means is that we can just sort of push JavaScript data into it without worrying too much about how that data is formatted.
- Now, in the case of MongoDB, what we can do is simply hand our database any kind of JSON that we want, and it will just store that for us and allow us to retrieve them later whenever we need them. All right, now this is in pretty stark contrast to some of the traditional relational databases, such as SQL-based databases like MySQL, where the structure of the data and the fields that it contains have to generally be defined in advance and adhered to whenever we add new data.
- All right, so working with relational databases also generally requires some knowledge of SQL, of course, and so by using this, we would sort of fall short of our ideal of being able to write our full stack application using only JavaScript. So anyway, that's MongoDB, and that's why we're going to be using it here. So let's get started and see how to add this to our app.
- https://www.mongodb.com/
- https://www.mysql.com/

## 2. Downloading and installing MongoDB

- All right, so now that we know what MongoDB is, and what we're going to be using it for, let's get it up and running on your computer. Now, if you're using a Mac like I am in this video, I highly recommend that you install MongoDB using Homebrew, Or if you're using some other operating systems such as Windows, I'm afraid that I really can't help you too much with that. But I'm going to direct you to MongoDB's installation instructions for MongoDB Community Edition.
- And in order to find these, all you have to do is search for MongoDB Community Edition installation tutorials, and you should be able to find this page, which contains a pretty extensive listing of all the different operating systems that you might need to install MongoDB on.
- So, like I said, the way that I'm going to be installing this on Mac is using something called homebrew, which is a really nice package manager for the Mac operating system, right? It is to Mac what, let's say, NPM is to Node JS projects. It just makes it really easy to install different things that you can use.
- So, I've already got Homebrew installed on my computer, but if you don't, you're going to want to go to Homebrew's website, which is http://www.brew.sh.com currently, and install it basically just by copying this script here, and running that in your terminal. You're just going to paste that in your terminal, and run it, and wait until it finishes. And once you've finished that what you should be able to do is go back to your terminal and type something like "brew-version" and hit enter, basically that will just tell you what version of Homebrew you have. Mine's currently 3, 5, 2, yours might be something higher than that, but all of this stuff should be pretty much the same.
- And, once you have Homebrew installed, you're going to want to install MongoDB by running the command "brew install". And, then you're going to say "MongoDB-community@5.0" now this "@5.0" thing, basically, that's just making sure that we're at the same version at the point that you're watching this there might be a later version, but you know, I would still recommend installing this just so everything's going to be the same for you. So let's hit enter, and this should install the MongoDB Community Server on our computer.

  - After installation add the bin folder path in environment PATH variable.

    [Download and Install MongoDB in Windows](https://www.mongodb.com/try/download/community)

    [Download and Install MongoDB shell](https://www.mongodb.com/try/download/shell)
    keep it in C folder

  - Check using this command 
    - `mongod --version`
    - `mongod`
  - You will get the error If you don't create the default directory. like this error
    ![](./mongodb-error.png)
  - Our data will be stored in the default directory.
- And, after that all we have to do is create the default database directory, where our MongoDB files are going to live. Now to do this, all we have to do is create a new folder inside our my blog backend. And, I'm just going to call this folder something like data. And in fact, we can even call it like MongoDB data if we want something like that, and this is going to be the folder that will have MongoDB store our data in.
  - data/db
- So, now that we've done that, what we should be able to do is start the "Mongo demon", which basically the Mongo demon is just a process that runs in the background, and allows us to interact with our database via a shell. For example, we'll see how to do that in a minute. And, we should be able to start the Mongo demon by saying "MongoD" and then we're going to say "--DB path", and we're going to point it at that folder we just created.
- So, we'll say "Mongodbdata" and hit enter, and that should start the Mongo demon running in the background. Now, I already have it running currently on my computer, so I'm not going to run this command, but you'll probably want to leave that running in your terminal, and just open up a new terminal alongside that. Okay, So once MongoDB is running you should be able to connect to it via the Mongo shell by typing **"Mongo" or "mongosh"**, and hitting enter. And, this again will bring up, what's called the Mongo shell which is basically just a little terminal that you can use to type in MongoDB commands.
- So, the first thing that we're going to do here is create a new database called "react blog DB". And, the way that we can do that is simply by typing "use", and then saying the database name, and our case "react-blog-DB" `use react-blog-DB`, and hitting enter. And, we're now in our database. So, what's next? Well, since we're planning on replacing this fake database JavaScript array thing that we had in our "Server.JS" file with MongoDB.

  ```
  use react-blog-DB
  ```

- What we're going to do is insert this data into our database so that we can persist it better. So, what this is going to look like is in our Mongo shell we're going to say "DB.articles.insertmany", and this is basically just a function that we call with all of the different documents that we want to insert.
- Now, before we do this, let's just go through a little bit of MongoDB terminology. This article's thing that you see here after DB is what's referred to as a collection. In MongoDB each database is composed of a few collections, or many collections, depending on how big your database is. And, these collections contain any number of JSON objects, and we call these objects documents.
- So, what we're going to insert here is a series of documents. And, basically all we need to do for that is copy what we had here for our articles info. So, I'm just going to select all of this and copy it. And, then we'll go down here and paste it, and I'm just going to hit paste. And then we just need to close off the parentheses, and hit enter. And, what you should see as output is this object that says "acknowledged true", which means that everything went well.
  ```
  db.articles.insertmany([{key: value}, {key: value}])
  ```
- And, we also have this inserted IDs thing, which is basically all of the randomly generated IDs that MongoDB has assigned to those things that we just inserted. So, if you want to see all of the documents in our database now, what you should be able to do is just say "DB.articles.find" with an empty object in between those parentheses there and hit enter. And, sure enough, you'll see all of that data printed out.
- Now, if you want to see this printed out in a nicer way, you can always add ".pretty" on the end of that. And, that will print that out in a nicely formatted way for us. Okay, so those are two of the basic commands that you'll be using in the MongoDB shell.
- One more thing that I want to point out is if you want to find a single object in MongoDB, right? If you want to filter by something, what you can do is for this find function, you're just going to specify some sort of property that you want to look for, and the value that it should contain.
- So let's say that we want to find the article with the name, "learn-react". Well, all we need to do for that is add "name-learn-react" to this object. This is called the query object in MongoDB. And if we hit enter, we'll see that that gives us the article that matches that criteria. Okay. And if there are several articles that match that criteria, it will just return all of them.
  ```
  db.articles.find({name: 'learn-react'}).pretty()
  ```
- So, we'll say up votes zero, for example if we want to get all of the articles that have zero up votes and, we'll see that that returns several articles. Okay, So at this point our database is set up to work with our backend.
  ```
  db.articles.find({upvotes: 0}).pretty()
  ```
- So, the next thing that we're going to see how to do is actually start incorporating MongoDB into our express server, and making queries to it from our endpoints. One last thing is that in order to exit out of your Mongo shell, all you need to do is press "control+C" ,and that will bring you back to your terminal.

## 3. Adding MongoDB to Express

## 4. Rewriting your upvote endpoint

## 5. Rewriting your comments endpoint
